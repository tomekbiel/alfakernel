<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Beverage Quality Classification with Random Forest</title>
    <link rel="stylesheet" href="../../../css/modern-style.css">
    <link href="https://fonts.googleapis.com/css2?family=MonteCarlo&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script defer src="../../../js/index.js"></script>
</head>
<body class="research-bg">
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left initials">
                <span>TB</span>
            </div>
            <div class="header-center">
                <a href="/alfakernel/index.html" class="logo">AlfaKernel</a>
                <div class="subtitle">The Core of Quantitative Finance</div>
            </div>
            <div class="header-right login-container">
                <button id="login-btn" class="login-btn">
                    <i class="fas fa-lock"></i> Sign in
                </button>
                <div id="login-form" class="login-form hidden">
                    <input type="email" placeholder="Email" />
                    <input type="password" placeholder="Password" />
                    <button type="submit" class="login-btn">Log In</button>
                </div>
            </div>
        </header>
        <main class="main-content">
            <section class="shiny-app-details">
                <h2>Beverage Quality Classification with Random Forest</h2>
                <p>
                    This project uses Random Forest and Decision Tree classifiers to predict beverage quality based on physicochemical properties.<br>
                    <strong>GitHub repository:</strong>
                    <a href="https://github.com/tomekbiel/python_data_analysis/tree/main/random_forest_example" target="_blank">
                        tomekbiel/python_data_analysis
                    </a>
                </p>
                <pre style="background:#232b36;color:#fff;padding:1em;border-radius:8px;overflow-x:auto;">
random_forest_example/
├── random_forest_baverages.py  # Main analysis script
├── random_forest_baverages.ipynb  # Jupyter notebook version
├── Beverage.csv              # Dataset
├── plots/                   # Output visualizations
│   ├── feature_importance.png
│   ├── confusion_matrix.png
│   └── clustering_results.png
├── README.md                 # Project documentation
└── requirements.txt          # Python dependencies
                </pre>
                <ul style="margin:1em 0 1em 1.2em;padding:0;">
                    <li><b>Dataset:</b> 4898 beverages, 11 features, binary target (Excellent/Other)</li>
                    <li><b>Preprocessing:</b> One-hot encoding, standardization, SMOTE balancing</li>
                    <li><b>Models:</b> Decision Tree, Random Forest (with tuning)</li>
                    <li><b>Results:</b> Random Forest accuracy up to 0.88</li>
                    <li><b>Clustering:</b> KMeans, PCA projection</li>
                </ul>
                <div style="margin:1.5em 0;">
                    <strong>Resources:</strong>
                    <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/refs/heads/random_forest_example/random_forest_baverages.py" download style="margin-left:1em;">
                        <i class="fas fa-file-code"></i> Python script
                    </a>
                    <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/refs/heads/random_forest_example/Beverage.csv" download style="margin-left:1em;">
                        <i class="fas fa-file-csv"></i> Dataset (CSV)
                    </a>
                    <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/refs/heads/random_forest_example/requirements.txt" download style="margin-left:1em;">
                        <i class="fas fa-file-alt"></i> requirements.txt
                    </a>
                    <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/refs/heads/random_forest_example/random_forest_baverages.ipynb" download style="margin-left:1em;">
                        <i class="fas fa-book"></i> Jupyter Notebook
                    </a>
                </div>
                <div style="margin:2em 0; display: flex; gap: 20px; flex-wrap: wrap;">
                    <a href="https://colab.research.google.com/github/tomekbiel/python_data_analysis/blob/main/random_forest_example/random_forest_baverages.ipynb" target="_blank" class="button">
                        <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" style="height:24px;vertical-align:middle;">
                        <span style="margin-left:0.5em;vertical-align:middle;">Open in Colab</span>
                    </a>
                    <a href="https://nbviewer.jupyter.org/github/tomekbiel/python_data_analysis/blob/main/random_forest_example/random_forest_baverages.ipynb" target="_blank" class="button">
                        <i class="fas fa-eye" style="margin-right:5px;"></i>
                        <span>View Notebook</span>
                    </a>
                    <a href="https://github.com/tomekbiel/python_data_analysis/tree/main/random_forest_example" target="_blank" class="button">
                        <i class="fab fa-github" style="margin-right:5px;"></i>
                        <span>View on GitHub</span>
                    </a>
                </div>
                <h3>Results & Visualizations</h3>
                <div class="results-gallery" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                    <figure style="margin:0;">
                        <img src="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/wyniki/feature_importance.png" 
                             alt="Feature Importance" 
                             style="width:100%; border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                        <figcaption style="text-align:center; margin-top:8px; color:#666;">Feature Importance</figcaption>
                    </figure>
                    <figure style="margin:0;">
                        <img src="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/wyniki/confusion_matrix.png" 
                             alt="Confusion Matrix" 
                             style="width:100%; border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                        <figcaption style="text-align:center; margin-top:8px; color:#666;">Confusion Matrix</figcaption>
                    </figure>
                    <figure style="margin:0;">
                        <img src="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/wyniki/clustering_results.png" 
                             alt="Clustering Results" 
                             style="width:100%; border-radius:8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                        <figcaption style="text-align:center; margin-top:8px; color:#666;">Clustering Results</figcaption>
                    </figure>
                </div>
                <h3 style="margin-top:2em;">Project Report</h3>
                <div style="max-width: 600px; background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <h4>Analysis Report</h4>
                    <p>Detailed analysis report with methodology, results, and conclusions.</p>
                    <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/Beverage%20Analysis%20Report.pdf" 
                       class="button" 
                       style="display: inline-flex; align-items: center; margin-top: 10px;">
                        <i class="fas fa-file-pdf" style="margin-right: 8px; color: #d73a49;"></i>
                        <span>View Report (PDF)</span>
                    </a>
                </div>

                <h3 style="margin-top:2em;">Jupyter Notebook</h3>
                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <p>Interactive notebook containing the complete analysis with code, visualizations, and explanations.</p>
                    <div style="margin: 15px 0;">
                        <a href="https://colab.research.google.com/github/tomekbiel/python_data_analysis/blob/random_forest_example/random_forest_baverages.ipynb" 
                           target="_blank" 
                           class="button" 
                           style="margin-right: 10px; margin-bottom: 10px;">
                            <i class="fab fa-google" style="margin-right: 8px;"></i>
                            Open in Google Colab
                        </a>
                        <a href="https://nbviewer.jupyter.org/github/tomekbiel/python_data_analysis/blob/random_forest_example/random_forest_baverages.ipynb" 
                           target="_blank" 
                           class="button" 
                           style="margin-right: 10px; margin-bottom: 10px;">
                            <i class="fas fa-eye" style="margin-right: 8px;"></i>
                            View in NBViewer
                        </a>
                        <a href="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/random_forest_baverages.ipynb" 
                           download 
                           class="button" 
                           style="margin-bottom: 10px;">
                            <i class="fas fa-download" style="margin-right: 8px;"></i>
                            Download Notebook
                        </a>
                    </div>
                    <div style="margin-top: 20px; padding: 15px; background: #fff; border-radius: 6px; border-left: 4px solid #4285f4;">
                        <h4 style="margin-top: 0; color: #333;">Notebook Preview</h4>
                        <p>For the best experience, we recommend opening the notebook in Google Colab or Jupyter Lab.</p>
                        <img src="https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/wyniki/notebook_preview.png" 
                             alt="Notebook Preview" 
                             style="width: 100%; border-radius: 4px; border: 1px solid #e1e4e8; margin-top: 10px;" 
                             onerror="this.src='https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/wyniki/feature_importance.png'">
                    </div>
                </div>

                <h3 style="margin-top:2em;">Project Documentation</h3>
                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <div id="readme-content">
                        <!-- README content will be loaded here -->
                        <p>Loading project documentation...</p>
                    </div>
                </div>
                
                <h3 style="margin-top:2em;">Jupyter Notebook Content</h3>
                <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                            max-height: 600px; overflow-y: auto;">
                    <pre style="background: #f5f5f5; padding: 15px; border-radius: 5px; white-space: pre-wrap; font-family: 'Courier New', monospace;">
# Beverage Quality Prediction with Random Forest

## Setup

```python
# Install required packages
!pip install scikit-learn imbalanced-learn seaborn matplotlib numpy pandas

# Import libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn import tree
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import GridSearchCV
from sklearn import metrics
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA
from imblearn.over_sampling import SMOTE
from sklearn.ensemble import RandomForestClassifier
```

## Data Loading and Preprocessing

```python
# Download the dataset
!wget -O Beverage.csv https://raw.githubusercontent.com/tomekbiel/python_data_analysis/refs/heads/random_forest_example/Beverage.csv

# Load the dataset
dataset = pd.read_csv("Beverage.csv")

# Convert quality to binary
def converter(column):
    if column == 'Excellent':
        return 1
    else:
        return 0

dataset['quality'] = dataset['quality'].apply(converter)
print("Dataset Info:")
print(dataset.info())

# One-hot encode categorical features
categorical_features = ['alcohol', 'volatile acidity', 'sulphates']
f_dat = pd.get_dummies(dataset, columns=categorical_features)
print("\nAfter One-Hot Encoding:")
print(f_dat.head())
```

## Data Preparation

```python
# Prepare features and target
X = f_dat.drop('quality', axis=1)
Y = f_dat['quality']

# Scale features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Split data into training and testing sets
X_train, X_test, Y_train, Y_test = train_test_split(X_scaled, Y, test_size=0.3, random_state=100)

# Handle class imbalance using SMOTE
print("Number of observations in each class before oversampling (training data):\n", 
      pd.Series(Y_train).value_counts())

smote = SMOTE(random_state=101)
X_train, Y_train = smote.fit_resample(X_train, Y_train)

print("Number of observations in each class after oversampling (training data):\n", 
      pd.Series(Y_train).value_counts())
```

## Model Training and Evaluation

```python
# Train Decision Tree Classifier
drzewo = tree.DecisionTreeClassifier(criterion='entropy', max_depth=5)
drzewo.fit(X_train, Y_train)

# Feature importance
featimp = pd.Series(drzewo.feature_importances_, index=list(X)).sort_values(ascending=False)
print(featimp)

# Make predictions and evaluate
Y_pred = drzewo.predict(X_test)
print("Prediction Accuracy: ", metrics.accuracy_score(Y_test, Y_pred))

# Confusion matrix
conf_mat = metrics.confusion_matrix(Y_test, Y_pred)
plt.figure(figsize=(8, 6))
sns.heatmap(conf_mat, annot=True)
plt.title("Confusion Matrix")
plt.xlabel("Predicted Class")
plt.ylabel("Actual Class")
plt.show()

# Cross-validation
all_accuracies = cross_val_score(estimator=drzewo, X=X_train, y=Y_train, cv=5)
print("Cross-validation accuracies:", all_accuracies)
print("Mean accuracy:", all_accuracies.mean())
print("Standard deviation:", all_accuracies.std())
```

## Hyperparameter Tuning

```python
# Grid search for best parameters
classifier = tree.DecisionTreeClassifier(criterion='entropy')
grid_param = {'max_depth': [2, 3, 4, 5, 10, 15, 20, 25, 30, 35]}

gd_sr = GridSearchCV(estimator=classifier, param_grid=grid_param, scoring='accuracy', cv=5)
gd_sr.fit(X_train, Y_train)

best_parameters = gd_sr.best_params_
print("Best parameters:", best_parameters)
print("Best score:", gd_sr.best_score_)
```

## Random Forest Classifier

```python
# Train and evaluate Random Forest
rfc = RandomForestClassifier(n_estimators=400, criterion='entropy', max_features='sqrt', random_state=1)
rfc.fit(X_train, Y_train)

# Feature importance
featimp = pd.Series(rfc.feature_importances_, index=list(X)).sort_values(ascending=False)
print(featimp)

# Make predictions and evaluate
Y_pred = rfc.predict(X_test)
print("Prediction Accuracy: ", metrics.accuracy_score(Y_test, Y_pred))

# Confusion matrix
conf_mat = metrics.confusion_matrix(Y_test, Y_pred)
plt.figure(figsize=(8, 6))
sns.heatmap(conf_mat, annot=True)
plt.title("Confusion Matrix")
plt.xlabel("Predicted Class")
plt.ylabel("Actual Class")
plt.show()
```

## Dimensionality Reduction with PCA

```python
# Apply PCA
pca = PCA(n_components=2)
pca.fit(X_scaled)
x_pca = pca.transform(X_scaled)
print("Explained variance ratio:", pca.explained_variance_ratio_)
print("Total explained variance:", sum(pca.explained_variance_ratio_))

# Plot PCA results
plt.figure(figsize=(8, 6))
plt.scatter(x_pca[:, 0], x_pca[:, 1], c=Y, cmap='plasma')
plt.xlabel('First Principal Component')
plt.ylabel('Second Principal Component')
plt.title('PCA of Beverage Quality Dataset')
plt.show()
```

## K-means Clustering

```python
# Apply K-means clustering
kmeans = KMeans(n_clusters=4)
kmeans.fit(X_scaled)
print("Cluster centers:", kmeans.cluster_centers_)

# Plot clusters
plt.figure(figsize=(8, 6))
plt.scatter(x_pca[:, 0], x_pca[:, 1], c=kmeans.labels_, cmap='viridis')
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], 
            s=300, c='red', marker='*')
plt.title('K-means Clustering Results')
plt.xlabel('First Principal Component')
plt.ylabel('Second Principal Component')
plt.show()
```
                    </pre>
                </div>
                
                <div id="readme-content">
                    <!-- README content will be loaded here -->
                    <p>Loading project documentation...</p>
                </div>
                <script>
                // Load README content from GitHub
                fetch('https://raw.githubusercontent.com/tomekbiel/python_data_analysis/random_forest_example/README.md')
                    .then(response => response.text())
                    .then(text => {
                        // Convert markdown to HTML (you might want to use a proper markdown parser in production)
                        const html = text
                            .replace(/^# (.*$)/gm, '<h4>$1</h4>')
                            .replace(/^## (.*$)/gm, '<h5>$1</h5>')
                            .replace(/^### (.*$)/gm, '<h6>$1</h6>')
                            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                            .replace(/\*(.*?)\*/g, '<em>$1</em>')
                            .replace(/^\s*\* (.*$)/gm, '<li>$1</li>')
                            .replace(/`(.*?)`/g, '<code>$1</code>')
                            .replace(/\n\n/g, '<br><br>');
                        
                        document.getElementById('readme-content').innerHTML = html;
                    })
                    .catch(error => {
                        console.error('Error loading README:', error);
                        document.getElementById('readme-content').innerHTML = 
                            '<p>Could not load project documentation. Please check the <a href="https://github.com/tomekbiel/python_data_analysis/tree/random_forest_example" target="_blank">GitHub repository</a>.</p>';
                    });
                </script>
            </section>
        </main>
    </div>
</body>
</html>